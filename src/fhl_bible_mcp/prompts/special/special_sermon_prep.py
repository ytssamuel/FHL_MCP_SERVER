"""è¬›é“æº–å‚™ Prompt

å”åŠ©æº–å‚™è¬›é“æˆ–æŸ¥ç¶“ï¼ŒåŒ…å«ç¶“æ–‡åˆ†æã€å¤§ç¶±å»ºè­°ã€ä¾‹è­‰å’Œæ‡‰ç”¨ã€‚
"""

from typing import Optional
from ..base import PromptTemplate


class SpecialSermonPrepPrompt(PromptTemplate):
    """è¬›é“æº–å‚™å°è©±ç¯„æœ¬
    
    å”åŠ©å…¨é¢æº–å‚™è¬›é“æˆ–æŸ¥ç¶“ææ–™ï¼ŒåŒ…å«ï¼š
    - ç¶“æ–‡æº–å‚™ï¼ˆå¤šç‰ˆæœ¬ã€ä¸Šä¸‹æ–‡ã€å¹³è¡Œç¶“æ–‡ï¼‰
    - è§£ç¶“ç ”ç©¶ï¼ˆåŸæ–‡ã€è¨»é‡‹ã€èƒŒæ™¯ï¼‰
    - å¤§ç¶±å»ºè­°ï¼ˆ3-5é»çµæ§‹åŒ–å¤§ç¶±ï¼‰
    - ä¾‹è­‰å»ºè­°ï¼ˆè–ç¶“æ•…äº‹ã€ç¾ä»£æ‡‰ç”¨ï¼‰
    - æ‡‰ç”¨æ–¹å‘ï¼ˆé‡å°ä¸åŒè½çœ¾ï¼‰
    - è£œå……è³‡æºï¼ˆç›¸é—œç¶“æ–‡ã€å»¶ä¼¸é–±è®€ï¼‰
    """
    
    def __init__(
        self,
        passage: str = "John 3:16",
        sermon_type: str = "expository",
        audience: str = "general",
        version: str = "unv"
    ):
        """åˆå§‹åŒ–è¬›é“æº–å‚™ Prompt
        
        Args:
            passage: ç¶“æ–‡ç¯„åœï¼ˆå¦‚ "John 3:16-21" æˆ– "Psalm 23"ï¼Œé è¨­ï¼šJohn 3:16ï¼‰
            sermon_type: è¬›é“é¡å‹
                - expository: è§£ç¶“å¼ï¼ˆé€ç¯€è¬›è§£ï¼‰
                - topical: ä¸»é¡Œå¼ï¼ˆåœç¹ä¸»é¡Œï¼‰
                - textual: ç¶“æ–‡å¼ï¼ˆå¾ç¶“æ–‡å¼•ç”³ï¼‰
            audience: è½çœ¾å°è±¡
                - general: ä¸€èˆ¬æœƒçœ¾
                - youth: é’å¹´åœ˜å¥‘
                - new_believers: åˆä¿¡è€…
                - mature: æˆç†Ÿä¿¡å¾’
            version: è–ç¶“ç‰ˆæœ¬ï¼ˆé è¨­ï¼šunv å’Œåˆæœ¬ï¼‰
        """
        super().__init__(
            name="special_sermon_prep",
            description="å…¨é¢æº–å‚™è¬›é“æˆ–æŸ¥ç¶“ï¼ŒåŒ…å«ç¶“æ–‡ã€å¤§ç¶±ã€æ‡‰ç”¨ç­‰",
            arguments=[
                {"name": "passage", "description": "ç¶“æ–‡ç¯„åœ", "required": False},
                {"name": "sermon_type", "description": "è¬›é“é¡å‹ (expository/topical/textual)", "required": False},
                {"name": "audience", "description": "è½çœ¾å°è±¡ (general/youth/new_believers/mature)", "required": False},
                {"name": "version", "description": "è–ç¶“ç‰ˆæœ¬", "required": False}
            ]
        )
        self.passage = passage
        self.sermon_type = sermon_type
        self.audience = audience
        self.version = version
    
    def render(
        self,
        passage: str = None,
        sermon_type: str = None,
        audience: str = None,
        version: str = None
    ) -> str:
        """æ¸²æŸ“è¬›é“æº–å‚™æŒ‡å¼•
        
        Args:
            passage: ç¶“æ–‡ï¼ˆå¯é¸ï¼Œä½¿ç”¨æ™‚è¦†è“‹åˆå§‹åŒ–å€¼ï¼‰
            sermon_type: è¬›é“é¡å‹ï¼ˆå¯é¸ï¼Œä½¿ç”¨æ™‚è¦†è“‹åˆå§‹åŒ–å€¼ï¼‰
            audience: è½çœ¾å°è±¡ï¼ˆå¯é¸ï¼Œä½¿ç”¨æ™‚è¦†è“‹åˆå§‹åŒ–å€¼ï¼‰
            version: è–ç¶“ç‰ˆæœ¬ï¼ˆå¯é¸ï¼Œä½¿ç”¨æ™‚è¦†è“‹åˆå§‹åŒ–å€¼ï¼‰
        """
        # ä½¿ç”¨å‚³å…¥çš„åƒæ•¸æˆ–åˆå§‹åŒ–æ™‚çš„å€¼ï¼ˆè‡¨æ™‚æ›´æ–° self å±¬æ€§ä»¥ä¾›å…§éƒ¨æ–¹æ³•ä½¿ç”¨ï¼‰
        if passage is not None:
            self.passage = passage
        if sermon_type is not None:
            self.sermon_type = sermon_type
        if audience is not None:
            self.audience = audience
        if version is not None:
            self.version = version
        
        sermon_types = {
            "expository": "è§£ç¶“å¼è¬›é“ï¼ˆExpositoryï¼‰",
            "topical": "ä¸»é¡Œå¼è¬›é“ï¼ˆTopicalï¼‰",
            "textual": "ç¶“æ–‡å¼è¬›é“ï¼ˆTextualï¼‰"
        }
        
        audience_info = {
            "general": {
                "name": "ä¸€èˆ¬æœƒçœ¾",
                "focus": "å¹³è¡¡æ•™å°èˆ‡æ‡‰ç”¨ï¼Œæ·±å…¥æ·ºå‡º",
                "tips": "ä½¿ç”¨ç”Ÿæ´»åŒ–ä¾‹è­‰ï¼Œé¿å…éå¤šç¥å­¸è¡“èª"
            },
            "youth": {
                "name": "é’å¹´åœ˜å¥‘",
                "focus": "è²¼è¿‘å¹´è¼•äººç”Ÿæ´»ï¼Œäº’å‹•æ€§å¼·",
                "tips": "ä½¿ç”¨ç•¶ä»£æ¡ˆä¾‹ï¼Œé¼“å‹µç™¼å•è¨è«–"
            },
            "new_believers": {
                "name": "åˆä¿¡è€…",
                "focus": "åŸºç¤æ•™å°ï¼Œå»ºç«‹ä¿¡ä»°æ ¹åŸº",
                "tips": "æ¸…æ¥šè§£é‡‹èƒŒæ™¯ï¼Œå¤šç”¨æ¯”å–»èªªæ˜"
            },
            "mature": {
                "name": "æˆç†Ÿä¿¡å¾’",
                "focus": "æ·±å…¥è§£ç¶“ï¼Œç¥å­¸æ¢è¨",
                "tips": "å¯æ¶‰åŠè¼ƒæ·±è­°é¡Œï¼ŒæŒ‘æˆ°éˆå‘½æˆé•·"
            }
        }
        
        sermon_type_name = sermon_types.get(self.sermon_type, "è§£ç¶“å¼è¬›é“")
        audience_data = audience_info.get(self.audience, audience_info["general"])
        
        prompt = f"""
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“– è¬›é“æº–å‚™åŠ©æ‰‹ - FHL Bible MCP Server
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

æ‚¨æ­£åœ¨æº–å‚™ä¸€ç¯‡è¬›é“/æŸ¥ç¶“ï¼š

ğŸ“ ç¶“æ–‡ç¯„åœï¼š{self.passage}
ğŸ¯ è¬›é“é¡å‹ï¼š{sermon_type_name}
ğŸ‘¥ è½çœ¾å°è±¡ï¼š{audience_data['name']}
ğŸ“š è–ç¶“ç‰ˆæœ¬ï¼š{self.version.upper()}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ’¡ è½çœ¾ç‰¹æ€§æç¤º
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ è¬›é“é‡é»ï¼š{audience_data['focus']}
â€¢ æº–å‚™å»ºè­°ï¼š{audience_data['tips']}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ç¬¬ä¸€æ­¥ï¼šç¶“æ–‡æº–å‚™
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

è«‹å”åŠ©æˆ‘å®Œæˆä»¥ä¸‹ç¶“æ–‡æº–å‚™å·¥ä½œï¼š

1ï¸âƒ£ **ä¸»è¦ç¶“æ–‡**
   è«‹ä½¿ç”¨ä»¥ä¸‹å·¥å…·å–å¾—ç¶“æ–‡ï¼š
   
   æ–¹æ³• A - å¦‚æœæ˜¯å–®ç« æˆ–å®Œæ•´æ®µè½ï¼š
   ```
   ä½¿ç”¨ get_bible_chapter å–å¾—å®Œæ•´ç« ç¯€
   æ›¸å·ï¼š{self._parse_book()}
   ç« ï¼š{self._parse_chapter()}
   ç‰ˆæœ¬ï¼š{self.version}
   ```
   
   æ–¹æ³• B - å¦‚æœæ˜¯ç‰¹å®šç¯„åœï¼š
   ```
   ä½¿ç”¨ get_bible_verses å–å¾—ç¶“æ–‡ç¯„åœ
   ç¶“æ–‡ï¼š{self.passage}
   ç‰ˆæœ¬ï¼š{self.version}
   ```
   
   ğŸ“Œ è«‹åŒæ™‚æä¾›ï¼š
   â€¢ å’Œåˆæœ¬ï¼ˆunvï¼‰
   â€¢ æ–°æ¨™å’Œåˆæœ¬ï¼ˆnstrunvï¼‰æˆ–
   â€¢ è‹±æ–‡ç‰ˆï¼ˆNIV/KJVï¼‰ä½œå°ç…§
   
   ğŸ’¡ ä½¿ç”¨ URI å¿«é€ŸæŸ¥è©¢ï¼š
   bible://verse/{self.version}/{self._parse_book()}/{self._parse_chapter()}/{self._parse_verse()}

2ï¸âƒ£ **ä¸Šä¸‹æ–‡ç¶“æ–‡**
   è«‹æŸ¥çœ‹ç¶“æ–‡å‰å¾Œçš„ä¸Šä¸‹æ–‡ï¼š
   
   â€¢ **å‰æ–‡**ï¼ˆäº†è§£èƒŒæ™¯è„ˆçµ¡ï¼‰ï¼š
     {self._get_context_before()}
   
   â€¢ **å¾Œæ–‡**ï¼ˆäº†è§£ç™¼å±•å»¶çºŒï¼‰ï¼š
     {self._get_context_after()}
   
   ğŸ’¡ ç†è§£ä¸Šä¸‹æ–‡æœ‰åŠ©æ–¼æº–ç¢ºè§£é‡‹ç¶“æ–‡

3ï¸âƒ£ **å¹³è¡Œç¶“æ–‡**ï¼ˆCross Referencesï¼‰
   è«‹ä½¿ç”¨ search_bible æ‰¾å‡ºç›¸é—œç¶“æ–‡ï¼š
   
   å»ºè­°æœå°‹é—œéµå­—ï¼š
   {self._suggest_keywords()}
   
   å°‹æ‰¾ä»¥ä¸‹é¡å‹çš„å¹³è¡Œç¶“æ–‡ï¼š
   â€¢ åŒä¸€ä¸»é¡Œçš„å…¶ä»–æ•™å°
   â€¢ èˆŠç´„é è¨€èˆ‡æ–°ç´„æ‡‰é©—
   â€¢ ç›¸ä¼¼çš„æ•˜äº‹æˆ–æ¯”å–»
   â€¢ ç›¸é—œçš„ç¥å­¸æ¦‚å¿µ

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ç¬¬äºŒæ­¥ï¼šè§£ç¶“ç ”ç©¶
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

è«‹é€²è¡Œæ·±å…¥çš„è§£ç¶“ç ”ç©¶ï¼š

1ï¸âƒ£ **åŸæ–‡åˆ†æ**
   è«‹ä½¿ç”¨ä»¥ä¸‹å·¥å…·ç ”ç©¶é—œéµå­—è©ï¼š
   
   â€¢ ä½¿ç”¨ get_word_analysis åˆ†æé‡è¦å­—è©
   â€¢ ä½¿ç”¨ lookup_strongs æŸ¥è©¢åŸæ–‡å­—ç¾©
   
   å»ºè­°åˆ†æçš„é—œéµå­—ï¼š
   {self._identify_key_words()}
   
   ğŸ’¡ é—œæ³¨ï¼š
   â€¢ åŸæ–‡çš„å­—é¢æ„æ€
   â€¢ åœ¨è–ç¶“ä¸­çš„å…¶ä»–ç”¨æ³•
   â€¢ ç¥å­¸æ„æ¶µ

2ï¸âƒ£ **è¨»é‡‹åƒè€ƒ**
   è«‹ä½¿ç”¨ get_commentary æŸ¥è©¢è¨»é‡‹ï¼š
   
   ```
   get_commentary(
       book="{self._parse_book()}",
       chapter={self._parse_chapter()},
       verse={self._parse_verse()}
   )
   ```
   
   ğŸ’¡ ç¶œåˆä¸åŒè¨»é‡‹æ›¸çš„è§€é»ï¼š
   â€¢ ä¸»æµè§£ç¶“ç«‹å ´
   â€¢ ä¸åŒç¥å­¸å‚³çµ±çš„çœ‹æ³•
   â€¢ çˆ­è­°é»åŠå…¶è§£æ±º

3ï¸âƒ£ **æ­·å²æ–‡åŒ–èƒŒæ™¯**
   è«‹æä¾›ä»¥ä¸‹èƒŒæ™¯è³‡è¨Šï¼š
   
   â€¢ **æ›¸å·èƒŒæ™¯**ï¼š
     ä½¿ç”¨ info://books æŸ¥è©¢æ›¸å·è³‡è¨Š
   
   â€¢ **æ­·å²æ™‚æœŸ**ï¼š
     {self._get_historical_period()}
   
   â€¢ **æ–‡åŒ–ç¿’ä¿—**ï¼š
     ç•¶æ™‚çš„ç¤¾æœƒã€å®—æ•™ã€æ–‡åŒ–èƒŒæ™¯
   
   â€¢ **æ–‡å­¸é«”è£**ï¼š
     {self._identify_genre()}

4ï¸âƒ£ **ç¥å­¸ä¸»é¡Œ**
   è­˜åˆ¥ç¶“æ–‡æ¶‰åŠçš„ç¥å­¸ä¸»é¡Œï¼š
   
   å¸¸è¦‹ä¸»é¡Œé¡åˆ¥ï¼š
   â€¢ ç¥è«–ï¼ˆä¸Šå¸çš„å±¬æ€§ï¼‰
   â€¢ åŸºç£è«–ï¼ˆè€¶ç©ŒåŸºç£ï¼‰
   â€¢ æ•‘æ©è«–ï¼ˆæ•‘è´–ï¼‰
   â€¢ è–éˆè«–
   â€¢ æ•™æœƒè«–
   â€¢ æœ«ä¸–è«–
   â€¢ å€«ç†é“å¾·
   
   ğŸ’¡ ä½¿ç”¨ search_bible æ‰¾å‡ºç›¸é—œä¸»é¡Œç¶“æ–‡

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ç¬¬ä¸‰æ­¥ï¼šè¬›é“å¤§ç¶±å»ºè­°
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

æ ¹æ“š **{sermon_type_name}** çš„ç‰¹é»ï¼Œè«‹æä¾›å¤§ç¶±å»ºè­°ï¼š

"""

        # æ ¹æ“šè¬›é“é¡å‹æä¾›ä¸åŒçš„å¤§ç¶±å»ºè­°
        if self.sermon_type == "expository":
            prompt += """
ğŸ“‹ **è§£ç¶“å¼è¬›é“å¤§ç¶±çµæ§‹**

å»ºè­°æ¡ç”¨é€æ®µè¬›è§£çš„æ–¹å¼ï¼š

I. å¼•è¨€ï¼ˆIntroductionï¼‰
   â€¢ å¼•èµ·èˆˆè¶£çš„é–‹å ´
   â€¢ ç¶“æ–‡èƒŒæ™¯ç°¡ä»‹
   â€¢ ä»Šæ—¥ç›¸é—œæ€§

II. ç¶“æ–‡è§£é‡‹ï¼ˆExpositionï¼‰
    ã€è«‹æ ¹æ“šç¶“æ–‡è‡ªç„¶æ®µè½ï¼Œåˆ†æˆ 3-5 å€‹è¦é»ã€‘
    
    ç¬¬ä¸€é»ï¼š____________
    â”œâ”€ ç¶“æ–‡ï¼š___:___-___
    â”œâ”€ è§£é‡‹ï¼šåŸæ–‡ã€æ–‡æ„ã€èƒŒæ™¯
    â”œâ”€ èªªæ˜ï¼šé€™æ®µåœ¨èªªä»€éº¼ï¼Ÿ
    â””â”€ æ‡‰ç”¨ï¼šå°æˆ‘å€‘çš„æ„ç¾©
    
    ç¬¬äºŒé»ï¼š____________
    â”œâ”€ ç¶“æ–‡ï¼š___:___-___
    â”œâ”€ è§£é‡‹ï¼šåŸæ–‡ã€æ–‡æ„ã€èƒŒæ™¯
    â”œâ”€ èªªæ˜ï¼šé€™æ®µåœ¨èªªä»€éº¼ï¼Ÿ
    â””â”€ æ‡‰ç”¨ï¼šå°æˆ‘å€‘çš„æ„ç¾©
    
    ç¬¬ä¸‰é»ï¼š____________
    ï¼ˆä¾æ­¤é¡æ¨...ï¼‰

III. ç¶œåˆæ‡‰ç”¨ï¼ˆApplicationï¼‰
     â€¢ ç¸½çµæ ¸å¿ƒä¿¡æ¯
     â€¢ å¯¦éš›ç”Ÿæ´»æ‡‰ç”¨
     â€¢ è¡Œå‹•å‘¼å¬

IV. çµèªï¼ˆConclusionï¼‰
    â€¢ å›é¡§è¦é»
    â€¢ æŒ‘æˆ°èˆ‡é¼“å‹µ
    â€¢ çµæŸç¦±å‘Š

ğŸ’¡ è§£ç¶“å¼è¬›é“é‡é»ï¼š
â€¢ å¿ æ–¼ç¶“æ–‡åŸæ„
â€¢ æŒ‰ç¶“æ–‡è‡ªç„¶çµæ§‹è¬›è§£
â€¢ æ¯å€‹è¦é»éƒ½æœ‰æ¸…æ¥šçš„ç¶“æ–‡æ”¯æŒ
â€¢ é¿å…éåº¦éˆæ„åŒ–
"""
        elif self.sermon_type == "topical":
            prompt += """
ğŸ“‹ **ä¸»é¡Œå¼è¬›é“å¤§ç¶±çµæ§‹**

å»ºè­°æ¡ç”¨ä¸»é¡Œå¼çš„å±•é–‹æ–¹å¼ï¼š

I. å¼•è¨€ï¼ˆIntroductionï¼‰
   â€¢ æå‡ºä¸»é¡Œ
   â€¢ èªªæ˜é‡è¦æ€§
   â€¢ ä»Šæ—¥æ‡‰ç”¨å ´æ™¯

II. ä¸»é¡Œç™¼å±•ï¼ˆDevelopmentï¼‰
    ã€è«‹åœç¹ä¸»é¡Œï¼Œæå‡º 3-5 å€‹è¦é»ã€‘
    
    ç¬¬ä¸€é»ï¼š______çš„å®šç¾©
    â”œâ”€ è–ç¶“å¦‚ä½•å®šç¾©é€™å€‹ä¸»é¡Œ
    â”œâ”€ ç›¸é—œç¶“æ–‡ï¼š______
    â””â”€ éŒ¯èª¤ç†è§£çš„æ¾„æ¸…
    
    ç¬¬äºŒé»ï¼š______çš„æ ¹æ“š
    â”œâ”€ èˆŠç´„ä¸­çš„______
    â”œâ”€ æ–°ç´„ä¸­çš„______
    â””â”€ ç¥å­¸åŸºç¤
    
    ç¬¬ä¸‰é»ï¼š______çš„å¯¦è¸
    â”œâ”€ å¦‚ä½•æ´»å‡º______
    â”œâ”€ å¯¦éš›ä¾‹å­
    â””â”€ å¸¸è¦‹æŒ‘æˆ°
    
    ï¼ˆå¯å†åŠ  1-2 é»ï¼‰

III. æ‡‰ç”¨èˆ‡å›æ‡‰ï¼ˆApplicationï¼‰
     â€¢ å°ä¸åŒè™•å¢ƒçš„æ‡‰ç”¨
     â€¢ å…·é«”è¡Œå‹•æ­¥é©Ÿ
     â€¢ å‘¼å¬èˆ‡æŒ‘æˆ°

IV. çµèªï¼ˆConclusionï¼‰
    â€¢ é‡ç”³ä¸»é¡Œæ ¸å¿ƒ
    â€¢ é¼“å‹µèˆ‡ç¥ç¦

ğŸ’¡ ä¸»é¡Œå¼è¬›é“é‡é»ï¼š
â€¢ ä¸»é¡Œæ˜ç¢ºèšç„¦
â€¢ å¤šè™•ç¶“æ–‡äº’ç›¸å°è­‰
â€¢ é‚è¼¯æ¸…æ™°ï¼Œå±¤å±¤æ¨é€²
â€¢ å¹³è¡¡æ•™ç¾©èˆ‡ç”Ÿæ´»
"""
        else:  # textual
            prompt += """
ğŸ“‹ **ç¶“æ–‡å¼è¬›é“å¤§ç¶±çµæ§‹**

å»ºè­°å¾ç¶“æ–‡å¼•ç”³å‡ºä¿¡æ¯è¦é»ï¼š

I. å¼•è¨€ï¼ˆIntroductionï¼‰
   â€¢ ç¶“æ–‡å°å…¥
   â€¢ ä¸­å¿ƒç¶“ç¯€å¼·èª¿
   â€¢ æå‡ºæ ¸å¿ƒå•é¡Œ

II. ä¿¡æ¯å±•é–‹ï¼ˆMessage Developmentï¼‰
    ã€å¾ç¶“æ–‡å¼•ç”³å‡º 3-5 å€‹ä¿¡æ¯è¦é»ã€‘
    
    ç¬¬ä¸€å€‹çœŸç†ï¼š____________
    â”œâ”€ ç¶“æ–‡ä¾æ“šï¼š{self.passage}
    â”œâ”€ çœŸç†èªªæ˜ï¼šé€™ç¶“æ–‡æ•™å°æˆ‘å€‘ä»€éº¼ï¼Ÿ
    â”œâ”€ è–ç¶“å°è­‰ï¼šå…¶ä»–ç¶“æ–‡çš„æ”¯æŒ
    â””â”€ ç”Ÿæ´»æ‡‰ç”¨ï¼šå¦‚ä½•å¯¦è¸é€™å€‹çœŸç†
    
    ç¬¬äºŒå€‹çœŸç†ï¼š____________
    â”œâ”€ ç¶“æ–‡ä¾æ“š
    â”œâ”€ çœŸç†èªªæ˜
    â”œâ”€ è–ç¶“å°è­‰
    â””â”€ ç”Ÿæ´»æ‡‰ç”¨
    
    ç¬¬ä¸‰å€‹çœŸç†ï¼š____________
    ï¼ˆä¾æ­¤é¡æ¨...ï¼‰

III. ç¶œåˆæ‡‰ç”¨ï¼ˆApplicationï¼‰
     â€¢ é€™äº›çœŸç†å¦‚ä½•æ”¹è®Šæˆ‘å€‘
     â€¢ å…·é«”è¡Œå‹•æ–¹å‘
     â€¢ è¦‹è­‰èˆ‡ä¾‹è­‰

IV. çµèªèˆ‡å‘¼å¬ï¼ˆConclusionï¼‰
    â€¢ é‡ç”³æ ¸å¿ƒä¿¡æ¯
    â€¢ æŒ‘æˆ°èˆ‡é‚€è«‹
    â€¢ ç¦±å‘Šå›æ‡‰

ğŸ’¡ ç¶“æ–‡å¼è¬›é“é‡é»ï¼š
â€¢ å¾ç¶“æ–‡å‡ºç™¼ï¼Œç·Šæ‰£ç¶“æ–‡
â€¢ å¼•ç”³çœŸç†ï¼Œä½†ä¸é›¢ç¶“æ–‡æœ¬æ„
â€¢ ä¿¡æ¯é€£è²«ï¼Œé‚è¼¯æ¸…æ™°
â€¢ å¹³è¡¡è§£ç¶“èˆ‡æ‡‰ç”¨
"""

        prompt += f"""

ğŸ“ **è«‹å”åŠ©æˆ‘ï¼š**
1. æ ¹æ“šç¶“æ–‡å…§å®¹ï¼Œæä¾›å…·é«”çš„å¤§ç¶±è¦é»
2. æ¯å€‹è¦é»æä¾›ç¶“æ–‡æ”¯æŒ
3. ç¢ºä¿é‚è¼¯é€£è²«ï¼Œé©åˆ {audience_data['name']}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ç¬¬å››æ­¥ï¼šä¾‹è­‰å»ºè­°
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

å¥½çš„ä¾‹è­‰èƒ½è®“ä¿¡æ¯ç”Ÿå‹•æœ‰åŠ›ï¼š

1ï¸âƒ£ **è–ç¶“ä¾‹è­‰**
   ä½¿ç”¨ search_bible æ‰¾å‡ºç›¸é—œçš„è–ç¶“æ•…äº‹æˆ–äººç‰©ï¼š
   
   å»ºè­°æœå°‹ï¼š
   â€¢ èˆ‡ä¸»é¡Œç›¸é—œçš„äººç‰©æ•…äº‹
   â€¢ é¡ä¼¼çš„äº‹ä»¶æˆ–æ¯”å–»
   â€¢ æ­·å²æ¡ˆä¾‹
   
   ğŸ’¡ è–ç¶“ä¾‹è­‰æœ€æœ‰æ¬Šå¨æ€§ï¼Œå„ªå…ˆä½¿ç”¨

2ï¸âƒ£ **æ­·å²è¦‹è­‰**
   æ•™æœƒæ­·å²æˆ–è–å¾’å‚³è¨˜ä¸­çš„ä¾‹å­ï¼š
   â€¢ ä¿¡å¿ƒå‰äººçš„è¦‹è­‰
   â€¢ æ•™æœƒå¾©èˆˆé‹å‹•
   â€¢ æ®‰é“è€…çš„æ¦œæ¨£

3ï¸âƒ£ **ç¾ä»£æ‡‰ç”¨å ´æ™¯**
   é‡å° **{audience_data['name']}** çš„ç”Ÿæ´»å ´æ™¯ï¼š
   
"""

        # é‡å°ä¸åŒè½çœ¾æä¾›ä¾‹è­‰å»ºè­°
        if self.audience == "youth":
            prompt += """   â€¢ å­¸æ¥­å£“åŠ›èˆ‡ä¿¡ä»°
   â€¢ äº¤å‹æˆ€æ„›çš„é¸æ“‡
   â€¢ ç¤¾ç¾¤åª’é«”æ™‚ä»£çš„æŒ‘æˆ°
   â€¢ å°‹æ‰¾äººç”Ÿæ–¹å‘
   â€¢ åŒå„•å£“åŠ›èˆ‡ç«‹å ´
"""
        elif self.audience == "new_believers":
            prompt += """   â€¢ æ–°ç”Ÿå‘½çš„æ”¹è®Šè¦‹è­‰
   â€¢ å¦‚ä½•å»ºç«‹éˆä¿®ç¿’æ…£
   â€¢ é¢å°è³ªç–‘æ™‚çš„å›æ‡‰
   â€¢ åœ¨è·å ´/å­¸æ ¡ç‚ºä¸»ä½œè¦‹è­‰
   â€¢ èˆ‡èˆŠæœ‹å‹çš„é—œä¿‚èª¿æ•´
"""
        elif self.audience == "mature":
            prompt += """   â€¢ æ·±åŒ–å±¬éˆç”Ÿå‘½
   â€¢ æœäº‹ä¸­çš„æŒ‘æˆ°
   â€¢ å¸¶é ˜ä»–äººæˆé•·
   â€¢ åœ¨é€†å¢ƒä¸­æŒå®ˆ
   â€¢ æ´»å‡ºä½¿å‘½
"""
        else:  # general
            prompt += """   â€¢ å®¶åº­é—œä¿‚
   â€¢ è·å ´å€«ç†
   â€¢ è²¡å‹™ç®¡ç†
   â€¢ äººéš›ç›¸è™•
   â€¢ ç¤¾æœƒé—œæ‡·
"""

        prompt += """
4ï¸âƒ£ **å€‹äººè¦‹è­‰**ï¼ˆå¦‚é©ç”¨ï¼‰
   â€¢ è‡ªå·±æˆ–ä»–äººçš„çœŸå¯¦ç¶“æ­·
   â€¢ å¦‚ä½•ç¶“æ­·ç¶“æ–‡ä¸­çš„çœŸç†
   â€¢ ç¥çš„ä¿¡å¯¦èˆ‡ä½œç‚º

ğŸ’¡ ä¾‹è­‰ä½¿ç”¨åŸå‰‡ï¼š
â€¢ çœŸå¯¦ã€è²¼åˆ‡ã€é©ç•¶
â€¢ ä¸å–§è³“å¥ªä¸»
â€¢ ç…§é¡§è½çœ¾æ„Ÿå—
â€¢ ä¿è­·ç•¶äº‹äººéš±ç§

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ç¬¬äº”æ­¥ï¼šæ‡‰ç”¨æ–¹å‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

"""

        prompt += f"""å°‡ç¶“æ–‡çœŸç†è½‰åŒ–ç‚ºç”Ÿæ´»å¯¦è¸ï¼ˆé‡å° **{audience_data['name']}**ï¼‰ï¼š

1ï¸âƒ£ **å€‹äººå±¤é¢**
   â€¢ æ€æƒ³ï¼šé€™æ®µç¶“æ–‡å¦‚ä½•æ”¹è®Šæˆ‘çš„æ€ç¶­ï¼Ÿ
   â€¢ æ…‹åº¦ï¼šæˆ‘éœ€è¦èª¿æ•´ä»€éº¼æ…‹åº¦ï¼Ÿ
   â€¢ è¡Œç‚ºï¼šå…·é«”è¦åšä»€éº¼è¡Œå‹•ï¼Ÿ
   â€¢ ç¿’æ…£ï¼šè¦å»ºç«‹æˆ–æ”¹è®Šä»€éº¼ç¿’æ…£ï¼Ÿ

2ï¸âƒ£ **äººéš›é—œä¿‚å±¤é¢**
   â€¢ å®¶åº­ï¼šåœ¨å®¶åº­ä¸­å¦‚ä½•å¯¦è¸ï¼Ÿ
   â€¢ æ•™æœƒï¼šåœ¨è‚¢é«”é—œä¿‚ä¸­çš„æ‡‰ç”¨
   â€¢ ç¤¾æœƒï¼šå°å‘¨åœçš„äººçš„å½±éŸ¿
   â€¢ è¦‹è­‰ï¼šå¦‚ä½•æ´»å‡ºè¦‹è­‰ï¼Ÿ

3ï¸âƒ£ **å±¬éˆç”Ÿå‘½å±¤é¢**
   â€¢ èˆ‡ç¥çš„é—œä¿‚ï¼šç¦±å‘Šã€è®€ç¶“ã€é †æœ
   â€¢ ä¿¡å¿ƒæˆé•·ï¼šå¦‚ä½•æ›´ä¿¡é ç¥ï¼Ÿ
   â€¢ å±¬éˆçˆ­æˆ°ï¼šå¦‚ä½•å¾—å‹è©¦æ¢ï¼Ÿ
   â€¢ äº‹å¥‰åƒèˆ‡ï¼šå¦‚ä½•å›æ‡‰ç¥çš„å‘¼å¬ï¼Ÿ

4ï¸âƒ£ **å…·é«”è¡Œå‹•è¨ˆåŠƒ**ï¼ˆSMART åŸå‰‡ï¼‰
   
   è«‹å¹«åŠ©æœƒçœ¾åˆ¶å®šå…·é«”å¯è¡Œçš„è¡Œå‹•ï¼š
   
   â€¢ **Specific**ï¼ˆå…·é«”ï¼‰ï¼šæ˜ç¢ºè¦åšä»€éº¼
   â€¢ **Measurable**ï¼ˆå¯è¡¡é‡ï¼‰ï¼šå¦‚ä½•çŸ¥é“æœ‰åšåˆ°
   â€¢ **Achievable**ï¼ˆå¯é”æˆï¼‰ï¼šå¯¦éš›å¯è¡Œçš„
   â€¢ **Relevant**ï¼ˆç›¸é—œï¼‰ï¼šèˆ‡ç¶“æ–‡ä¿¡æ¯ç›¸é—œ
   â€¢ **Time-bound**ï¼ˆæœ‰æ™‚é™ï¼‰ï¼šæœ¬é€±/æœ¬æœˆè¦å®Œæˆ
   
   ç¯„ä¾‹è¡Œå‹•ï¼š
   - æ¯å¤©æ—©æ™¨èŠ± 15 åˆ†é˜è®€ç¶“ç¦±å‘Šï¼ˆæœ¬é€±é–‹å§‹ï¼‰
   - æœ¬é€±è‡³å°‘å‘ä¸€å€‹äººåˆ†äº«é€™æ®µç¶“æ–‡
   - æœ¬æœˆå…§èˆ‡å®¶äººå’Œè§£ï¼ˆå…·é«”å°è±¡ï¼‰
   - æ“ç·´é¥’æ•ï¼šæ”¾ä¸‹ä¸€å€‹éå¾€çš„å‚·å®³

5ï¸âƒ£ **æŒ‘æˆ°èˆ‡å‘¼å¬**
   
   ä¿¡æ¯æœ€å¾Œçš„æŒ‘æˆ°ï¼š
   â€¢ ä½ é¡˜æ„ä¿¡é é€™ä½ç¥å—ï¼Ÿ
   â€¢ ä½ é¡˜æ„é †æœç¥çš„è©±èªå—ï¼Ÿ
   â€¢ ä½ é¡˜æ„æ”¹è®Šå—ï¼Ÿ
   â€¢ ä½ é¡˜æ„è¸å‡ºä¿¡å¿ƒçš„ä¸€æ­¥å—ï¼Ÿ
   
   ğŸ’¡ çµ¦äºˆç›¼æœ›èˆ‡é¼“å‹µï¼Œè€Œéå®šç½ª

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ç¬¬å…­æ­¥ï¼šè£œå……è³‡æº
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

æº–å‚™é¡å¤–çš„åƒè€ƒè³‡æ–™ï¼š

1ï¸âƒ£ **ç›¸é—œç¶“æ–‡æ¸…å–®**
   
   è«‹ä½¿ç”¨ search_bible æ•´ç†ï¼š
   â€¢ ç›¸åŒä¸»é¡Œçš„ç¶“æ–‡ï¼ˆ5-10 è™•ï¼‰
   â€¢ å¹³è¡Œç¶“æ–‡
   â€¢ å»¶ä¼¸é–±è®€ç¶“æ–‡
   
   æ•´ç†æˆæ¸…å–®ä¾›æœƒçœ¾èª²å¾Œç ”è®€

2ï¸âƒ£ **æ·±å…¥ç ”ç¶“è³‡æ–™**
   
   â€¢ ä½¿ç”¨ get_commentary æ•´ç†è¨»é‡‹æ‘˜è¦
   â€¢ åˆ—å‡ºé—œéµåŸæ–‡å­—è©åŠå…¶ Strong's Number
   â€¢ æä¾› URI é€£çµæ–¹ä¾¿å»¶ä¼¸æŸ¥è©¢ï¼š
     - bible://{self.version}/...
     - strongs://nt/... æˆ– strongs://ot/...
     - commentary://...

3ï¸âƒ£ **å°çµ„è¨è«–å•é¡Œ**ï¼ˆå¦‚é©ç”¨ï¼‰
   
   è¨­è¨ˆ 3-5 å€‹è¨è«–å•é¡Œï¼š
   â€¢ é–‹æ”¾å¼å•é¡Œï¼Œå¼•ç™¼æ€è€ƒ
   â€¢ é€£çµå¯¦éš›ç”Ÿæ´»
   â€¢ ä¿ƒé€²åˆ†äº«èˆ‡æ‡‰ç”¨
   
   ç¯„ä¾‹æ ¼å¼ï¼š
   1. é€™æ®µç¶“æ–‡å°ä½ æœ€å¤§çš„æŒ‘æˆ°æ˜¯ä»€éº¼ï¼Ÿ
   2. åˆ†äº«ä¸€å€‹ä½ å¦‚ä½•å¯¦è¸ç¶“æ–‡çš„ç¶“æ­·
   3. æˆ‘å€‘å¯ä»¥å¦‚ä½•å½¼æ­¤å¹«åŠ©æ´»å‡ºé€™å€‹çœŸç†ï¼Ÿ

4ï¸âƒ£ **èƒŒèª¦ç¶“æ–‡**
   
   é¸å‡º 1-2 ç¯€é‡‘å¥ï¼š
   â€¢ ä»£è¡¨æœ¬æ®µç¶“æ–‡æ ¸å¿ƒä¿¡æ¯
   â€¢ å®¹æ˜“è¨˜æ†¶
   â€¢ å¯¦ç”¨æ€§å¼·
   
   å»ºè­°é‡‘å¥ï¼š{self._suggest_memory_verse()}

5ï¸âƒ£ **ç¦±å‘Šæ–¹å‘**
   
   æ ¹æ“šä¿¡æ¯å…§å®¹ï¼Œæä¾›ç¦±å‘Šæ–¹å‘ï¼š
   â€¢ æ„Ÿæ©ï¼šç‚ºç¥çš„è©±èªå’ŒçœŸç†æ„Ÿæ©
   â€¢ èªç½ªï¼šæ‰¿èªè‡ªå·±çš„ä¸è¶³å’Œè»Ÿå¼±
   â€¢ ç¥ˆæ±‚ï¼šæ±‚ç¥å¹«åŠ©æˆ‘å€‘éµè¡Œç¥‚çš„è©±
   â€¢ ä»£æ±‚ï¼šç‚ºæ•™æœƒã€å®¶äººã€ç¤¾æœƒä»£ç¦±

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“‹ è¬›é“æº–å‚™æª¢æŸ¥æ¸…å–®
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

åœ¨å®Œæˆè¬›é“ç¨¿å¾Œï¼Œè«‹æª¢æŸ¥ï¼š

âœ… **å…§å®¹æª¢æŸ¥**
â–¡ å¿ æ–¼ç¶“æ–‡åŸæ„ï¼Œæ²’æœ‰æ›²è§£
â–¡ è§£ç¶“æº–ç¢ºï¼Œæœ‰è¨»é‡‹æ”¯æŒ
â–¡ å¤§ç¶±æ¸…æ™°ï¼Œé‚è¼¯é€£è²«
â–¡ ä¾‹è­‰åˆå®œï¼Œä¸å–§è³“å¥ªä¸»
â–¡ æ‡‰ç”¨å…·é«”ï¼Œå¯è¡Œæ€§é«˜

âœ… **è½çœ¾é©åˆ‡æ€§**
â–¡ èªè¨€æ·±æ·ºåº¦é©åˆ {audience_data['name']}
â–¡ ä¾‹è­‰èƒ½å¼•èµ·å…±é³´
â–¡ æ‡‰ç”¨è²¼è¿‘ç”Ÿæ´»
â–¡ æ™‚é–“é•·åº¦é©ä¸­ï¼ˆå»ºè­° 30-45 åˆ†é˜ï¼‰

âœ… **å±¬éˆæœæ•ˆ**
â–¡ é«˜èˆ‰åŸºç£ï¼Œæ¦®è€€ä¸Šå¸
â–¡ é€ å°±ä¿¡å¾’ï¼Œå …å›ºä¿¡å¿ƒ
â–¡ æŒ‘æˆ°é †æœï¼Œæ´»å‡ºçœŸç†
â–¡ å‚³éç›¼æœ›ï¼Œä¸æ˜¯å®šç½ª

âœ… **å¯¦éš›æº–å‚™**
â–¡ å¤šæ¬¡ç·´ç¿’è¬›é“
â–¡ æª¢æŸ¥æ‰€æœ‰ç¶“æ–‡å¼•ç”¨
â–¡ æº–å‚™æŠ•å½±ç‰‡æˆ–è¬›ç¾©
â–¡ ç‚ºè¬›é“ä»£ç¦±
â–¡ é å‚™è‡ªå·±çš„å¿ƒ

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ã€å·¥å…·å¿«é€Ÿåƒè€ƒã€‘

æŸ¥è©¢ç¶“æ–‡ï¼š
â€¢ get_bible_chapter - å–å¾—æ•´ç« 
â€¢ get_bible_verses - å–å¾—ç¶“æ–‡ç¯„åœ
â€¢ URI: bible://{self.version}/{self._parse_book()}/...

æœå°‹ç›¸é—œç¶“æ–‡ï¼š
â€¢ search_bible - æœå°‹é—œéµå­—

åŸæ–‡ç ”ç©¶ï¼š
â€¢ get_word_analysis - å­—è©åˆ†æ
â€¢ lookup_strongs - Strong's å­—å…¸
â€¢ URI: strongs://nt/[ç·¨è™Ÿ] æˆ– strongs://ot/[ç·¨è™Ÿ]

æŸ¥è©¢è¨»é‡‹ï¼š
â€¢ get_commentary - å–å¾—è¨»é‡‹
â€¢ URI: commentary://{self._parse_book()}/...

æ›¸å·è³‡è¨Šï¼š
â€¢ info://books - æ›¸å·åˆ—è¡¨å’Œç°¡ä»‹
â€¢ info://versions - è–ç¶“ç‰ˆæœ¬

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ™ é¡˜ç¥ä½¿ç”¨æ‚¨å¿ å¿ƒé å‚™çš„ä¿¡æ¯ï¼Œç¥ç¦ç¥‚çš„æ•™æœƒï¼

"ä½ ç•¶ç«­åŠ›åœ¨ç¥é¢å‰å¾—è’™å–œæ‚…ï¼Œä½œç„¡æ„§çš„å·¥äººï¼Œ
  æŒ‰è‘—æ­£æ„åˆ†è§£çœŸç†çš„é“ã€‚" ï¼ˆææ‘©å¤ªå¾Œæ›¸ 2:15ï¼‰

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"""
        
        return prompt.strip()
    
    def _parse_book(self) -> str:
        """è§£ææ›¸å·åç¨±"""
        parts = self.passage.split()
        if parts:
            return parts[0]
        return "John"
    
    def _parse_chapter(self) -> str:
        """è§£æç« æ•¸"""
        import re
        match = re.search(r'(\d+)', self.passage)
        if match:
            return match.group(1)
        return "1"
    
    def _parse_verse(self) -> str:
        """è§£æç¯€æ•¸"""
        import re
        match = re.search(r'(\d+):(\d+)', self.passage)
        if match:
            return match.group(2)
        return "1"
    
    def _get_context_before(self) -> str:
        """ç²å–å‰æ–‡å»ºè­°"""
        chapter = self._parse_chapter()
        try:
            ch_num = int(chapter)
            if ch_num > 1:
                return f"å‰ä¸€ç« ï¼š{self._parse_book()} {ch_num - 1} ç« "
            else:
                return "ï¼ˆå·²æ˜¯æœ¬æ›¸ç¬¬ä¸€ç« ï¼‰"
        except:
            return f"{self._parse_book()} å‰æ–‡"
    
    def _get_context_after(self) -> str:
        """ç²å–å¾Œæ–‡å»ºè­°"""
        chapter = self._parse_chapter()
        try:
            ch_num = int(chapter)
            return f"å¾Œä¸€ç« ï¼š{self._parse_book()} {ch_num + 1} ç« "
        except:
            return f"{self._parse_book()} å¾Œæ–‡"
    
    def _suggest_keywords(self) -> str:
        """å»ºè­°æœå°‹é—œéµå­—"""
        book = self._parse_book().lower()
        
        # æ ¹æ“šæ›¸å·æä¾›å»ºè­°
        suggestions = {
            "john": "æ„›ã€æ°¸ç”Ÿã€å…‰ã€ä¿¡ã€è¦‹è­‰",
            "psalm": "è®šç¾ã€è€¶å’Œè¯ã€æ…ˆæ„›ã€æ‹¯æ•‘ã€ä¿è­·",
            "romans": "ç¦éŸ³ã€ç¨±ç¾©ã€æ©å…¸ã€å¾‹æ³•ã€ä¿¡å¿ƒ",
            "matthew": "å¤©åœ‹ã€é–€å¾’ã€æ•™å°ã€éµè¡Œã€ä¿¡å¿ƒ",
            "genesis": "å‰µé€ ã€æ‡‰è¨±ã€æ€é¸ã€ç«‹ç´„ã€ç¥ç¦"
        }
        
        for key, value in suggestions.items():
            if key in book.lower():
                return value
        
        return "ï¼ˆæ ¹æ“šç¶“æ–‡ä¸»é¡Œé¸æ“‡é—œéµå­—ï¼‰"
    
    def _identify_key_words(self) -> str:
        """è­˜åˆ¥éœ€è¦åˆ†æçš„é—œéµå­—"""
        return "ï¼ˆè«‹å…ˆé–±è®€ç¶“æ–‡ï¼Œè­˜åˆ¥é‡è¤‡å‡ºç¾æˆ–é‡è¦çš„å­—è©ï¼‰"
    
    def _get_historical_period(self) -> str:
        """ç²å–æ­·å²æ™‚æœŸ"""
        book = self._parse_book().lower()
        
        if any(b in book for b in ["genesis", "exodus", "leviticus", "numbers", "deuteronomy"]):
            return "æ‘©è¥¿æ™‚æœŸï¼ˆç´„å…¬å…ƒå‰ 1400 å¹´ï¼‰"
        elif any(b in book for b in ["matthew", "mark", "luke", "john"]):
            return "è€¶ç©Œæ™‚æœŸï¼ˆç´„å…¬å…ƒ 30 å¹´ï¼‰"
        elif any(b in book for b in ["acts", "romans", "corinthians", "galatians"]):
            return "åˆä»£æ•™æœƒæ™‚æœŸï¼ˆç´„å…¬å…ƒ 50-100 å¹´ï¼‰"
        
        return "ï¼ˆè«‹æŸ¥è©¢æ›¸å·èƒŒæ™¯è³‡è¨Šï¼‰"
    
    def _identify_genre(self) -> str:
        """è­˜åˆ¥æ–‡å­¸é«”è£"""
        book = self._parse_book().lower()
        
        genres = {
            "narrative": ["genesis", "exodus", "joshua", "judges", "ruth", "samuel", "kings", 
                         "chronicles", "ezra", "nehemiah", "esther", "matthew", "mark", 
                         "luke", "john", "acts"],
            "law": ["exodus", "leviticus", "numbers", "deuteronomy"],
            "poetry": ["job", "psalm", "proverbs", "ecclesiastes", "song"],
            "prophecy": ["isaiah", "jeremiah", "ezekiel", "daniel", "hosea", "joel", 
                        "amos", "obadiah", "jonah", "micah", "nahum", "habakkuk", 
                        "zephaniah", "haggai", "zechariah", "malachi", "revelation"],
            "epistle": ["romans", "corinthians", "galatians", "ephesians", "philippians",
                       "colossians", "thessalonians", "timothy", "titus", "philemon",
                       "hebrews", "james", "peter", "john", "jude"],
            "wisdom": ["job", "proverbs", "ecclesiastes"]
        }
        
        for genre, books in genres.items():
            if any(b in book for b in books):
                genre_names = {
                    "narrative": "æ•˜äº‹æ–‡é«”ï¼ˆNarrativeï¼‰",
                    "law": "å¾‹æ³•æ–‡é«”ï¼ˆLawï¼‰",
                    "poetry": "è©©æ­Œæ–‡é«”ï¼ˆPoetryï¼‰",
                    "prophecy": "å…ˆçŸ¥é è¨€ï¼ˆProphecyï¼‰",
                    "epistle": "æ›¸ä¿¡é«”ï¼ˆEpistleï¼‰",
                    "wisdom": "æ™ºæ…§æ–‡å­¸ï¼ˆWisdomï¼‰"
                }
                return genre_names.get(genre, "æ··åˆé«”è£")
        
        return "è«‹åˆ¤æ–·ç¶“æ–‡çš„æ–‡å­¸é«”è£"
    
    def _suggest_memory_verse(self) -> str:
        """å»ºè­°èƒŒèª¦ç¶“æ–‡"""
        return f"ï¼ˆå»ºè­°å¾ {self.passage} ä¸­é¸æ“‡ 1-2 ç¯€æ ¸å¿ƒç¶“æ–‡ï¼‰"
